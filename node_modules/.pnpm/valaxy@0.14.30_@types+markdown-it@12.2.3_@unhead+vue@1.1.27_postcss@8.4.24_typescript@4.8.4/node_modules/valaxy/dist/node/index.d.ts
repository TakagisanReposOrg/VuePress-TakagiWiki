import { ViteSSGOptions } from 'vite-ssg';
export { cli, run } from './cli.js';
import * as vite from 'vite';
import { UserConfig, InlineConfig } from 'vite';
import { D as DefaultThemeConfig, V as ValaxyConfig, P as PartialDeep, a as ValaxyAddon, R as RuntimeConfig, U as UserSiteConfig, S as SiteConfig } from '../config-19412c54.js';
import Vue from '@vitejs/plugin-vue';
import Components from 'unplugin-vue-components/vite';
import { VitePluginConfig } from 'unocss/vite';
import Pages from 'vite-plugin-pages';
import { presetUno, presetAttributify, presetIcons, presetTypography } from 'unocss';
import MarkdownIt from 'markdown-it';
import { IThemeRegistration } from 'shiki';
import anchorPlugin from 'markdown-it-anchor';
import { KatexOptions } from 'katex';
import { FrontmatterPluginOptions } from '@mdit-vue/plugin-frontmatter';
import { HeadersPluginOptions } from '@mdit-vue/plugin-headers';
import { SfcPluginOptions } from '@mdit-vue/plugin-sfc';
import { TocPluginOptions } from '@mdit-vue/plugin-toc';
import { Awaitable } from '@antfu/utils';
import * as defu from 'defu';
import 'yargs';
import 'medium-zoom';

declare module 'vite' {
    interface UserConfig {
        ssgOptions?: ViteSSGOptions;
    }
}

interface BlockItem {
    text?: string;
    icon?: string;
    color?: string;
    /**
     * for i18n
     */
    langs?: {
        [key: string]: string;
    };
}
interface Blocks {
    tip?: BlockItem;
    warning?: BlockItem;
    danger?: BlockItem;
    info?: BlockItem;
    details?: BlockItem;
}

type ThemeOptions = IThemeRegistration | {
    light: IThemeRegistration;
    dark: IThemeRegistration;
};
interface MarkdownOptions {
    /**
     * markdown-it options
     */
    options?: MarkdownIt.Options;
    /**
     * config markdown-it
     */
    config?: (md: MarkdownIt) => void;
    anchor?: anchorPlugin.AnchorOptions;
    attrs?: {
        leftDelimiter?: string;
        rightDelimiter?: string;
        allowedAttributes?: string[];
        disable?: boolean;
    };
    frontmatter?: FrontmatterPluginOptions;
    headers?: HeadersPluginOptions;
    sfc?: SfcPluginOptions;
    toc?: TocPluginOptions;
    katex?: KatexOptions;
    /**
     * shiki
     */
    theme?: ThemeOptions;
    /**
     * Custom block configurations
     */
    blocks?: Blocks;
    externalLinks?: Record<string, string>;
}

type ValaxyNodeConfig<ThemeConfig = DefaultThemeConfig> = ValaxyConfig<ThemeConfig> & ValaxyExtendConfig;
type UserValaxyNodeConfig<ThemeConfig = DefaultThemeConfig> = PartialDeep<ValaxyNodeConfig<ThemeConfig>>;
/**
 * fn with options for theme config
 */
type ValaxyConfigFn<ThemeConfig = DefaultThemeConfig> = (options: ResolvedValaxyOptions<ThemeConfig>) => ValaxyNodeConfig | Promise<ValaxyNodeConfig>;
type ValaxyConfigExport<ThemeConfig = DefaultThemeConfig> = ValaxyNodeConfig<ThemeConfig> | ValaxyConfigFn<ThemeConfig>;
interface ValaxyExtendConfig {
    /**
     * Markdown Feature
     */
    features: {
        /**
         * enable katex for global
         */
        katex: boolean;
    };
    vite?: UserConfig;
    vue?: Parameters<typeof Vue>[0];
    components?: Parameters<typeof Components>[0];
    unocss?: VitePluginConfig;
    /**
     * unocss presets
     */
    unocssPresets?: {
        uno?: Parameters<typeof presetUno>[0];
        attributify?: Parameters<typeof presetAttributify>[0];
        icons?: Parameters<typeof presetIcons>[0];
        typography?: Parameters<typeof presetTypography>[0];
    };
    pages?: Parameters<typeof Pages>[0];
    /**
     * for markdown
     */
    markdown?: MarkdownOptions;
    extendMd?: (ctx: {
        route: {
            meta: {
                frontmatter: Record<string, any>;
                layout?: string;
            } & {};
            path: string;
            component: string;
        };
        data: Readonly<Record<string, any>>;
        content: string;
        excerpt?: string;
        path: string;
    }) => void;
    addons?: ValaxyAddons;
}
type ValaxyAddonLike = ValaxyAddon | false | null | undefined;
type ValaxyAddons = (ValaxyAddon | string)[] | Record<string, ValaxyAddonLike>;
type ValaxyAddonFn<ThemeConfig = DefaultThemeConfig> = (addonOptions: ValaxyAddonResolver, valaxyOptions: ResolvedValaxyOptions<ThemeConfig>) => ValaxyNodeConfig | Promise<ValaxyNodeConfig>;
type ValaxyAddonExport<ThemeConfig = DefaultThemeConfig> = ValaxyNodeConfig<ThemeConfig> | ValaxyAddonFn<ThemeConfig>;
interface ValaxyAddonResolver {
    name: string;
    root: string;
    enable: boolean;
    global: boolean;
    props: Record<string, any>;
    options: Record<string, any>;
    configFile?: string;
}

interface ValaxyEntryOptions {
    /**
     * theme name
     */
    theme?: string;
    userRoot: string;
}
interface ResolvedValaxyOptions<ThemeConfig = DefaultThemeConfig> {
    mode: 'dev' | 'build';
    /**
     * package.json root
     */
    pkgRoot: string;
    /**
     * Client root path
     * @default 'valaxy/client'
     */
    clientRoot: string;
    /**
     * User root path
     * @default process.cwd()
     */
    userRoot: string;
    /**
     * Theme root path
     */
    themeRoot: string;
    /**
     * Addon root path
     */
    addonRoots: string[];
    /**
     * Theme name
     */
    roots: string[];
    theme: string;
    /**
     * Valaxy Config
     */
    config: ValaxyNodeConfig<ThemeConfig> & {
        /**
         * Generated Runtime Config
         */
        runtimeConfig: RuntimeConfig;
    };
    /**
     * config file path
     */
    configFile: string;
    siteConfigFile: string;
    themeConfigFile: string;
    pages: string[];
    /**
     * all addons
     * Record<package-name, OptionResolver>
     */
    addons: ValaxyAddonResolver[];
}
interface ValaxyServerOptions {
    onConfigReload?: (newConfig: ValaxyNodeConfig, config: ValaxyNodeConfig, force?: boolean) => void;
}
/**
 * Post process valaxyOptions
 * @param valaxyOptions
 * @param valaxyConfig
 */
declare function processValaxyOptions(valaxyOptions: ResolvedValaxyOptions, valaxyConfig: ValaxyNodeConfig): Promise<ResolvedValaxyOptions<DefaultThemeConfig>>;
declare function resolveOptions(options?: ValaxyEntryOptions, mode?: ResolvedValaxyOptions['mode']): Promise<ResolvedValaxyOptions<DefaultThemeConfig>>;
/**
 * resolve theme config
 * @param options
 * @returns
 */
declare function resolveThemeValaxyConfig(options: ResolvedValaxyOptions): Promise<ValaxyNodeConfig>;

/**
 * merge vite.config.ts (user & theme)
 * @internal
 * @param param
 * @param command
 * @returns
 */
declare function mergeViteConfigs({ userRoot, themeRoot }: ResolvedValaxyOptions, command: 'serve' | 'build'): Promise<InlineConfig>;
/**
 * generate index.html from user/theme/client
 * @internal
 * @param
 * @returns
 */
declare function getIndexHtml({ clientRoot, themeRoot, userRoot, config }: ResolvedValaxyOptions): Promise<string>;

declare function build(options: ResolvedValaxyOptions, viteConfig?: InlineConfig): Promise<void>;
declare function ssgBuild(options: ResolvedValaxyOptions, viteConfig?: InlineConfig): Promise<void>;
/**
 * post process for ssg fix extra string like `/html>` `ml>` `l>`
 * todo find why
 * @param options
 */
declare function postProcessForSSG(options: ResolvedValaxyOptions): Promise<void>;

declare function defineValaxyAddon<AddonOptions = {}>(addonFunc: (addonOptions?: AddonOptions, valaxyOptions?: ResolvedValaxyOptions) => ValaxyAddon): (addonOptions?: AddonOptions, valaxyOptions?: ResolvedValaxyOptions) => ValaxyAddon;
declare const defineAddon: typeof defineValaxyAddon;
type ValaxyConfigExtendKey = 'vite' | 'vue' | 'unocss' | 'unocssPresets' | 'markdown' | 'extendMd' | 'addons';
type ValaxyPickConfig = Pick<ValaxyNodeConfig, ValaxyConfigExtendKey>;
type ValaxyTheme<ThemeConfig = DefaultThemeConfig> = ValaxyPickConfig & {
    themeConfig?: ThemeConfig;
};
declare function defineValaxyTheme<ThemeConfig = DefaultThemeConfig>(theme: ValaxyTheme<ThemeConfig> | ((options: ResolvedValaxyOptions<ThemeConfig>) => ValaxyTheme<ThemeConfig>)): ValaxyTheme<ThemeConfig> | ((options: ResolvedValaxyOptions<ThemeConfig>) => ValaxyTheme<ThemeConfig>);
declare const defineTheme: typeof defineValaxyTheme;

/**
 * Type helper for site.config.ts
 * @param config
 * @returns
 */
declare function defineSiteConfig(config: UserSiteConfig): PartialDeep<SiteConfig>;
/**
 * Type helper for valaxy.config.ts
 */
declare function defineValaxyConfig<ThemeConfig>(config: UserValaxyNodeConfig<ThemeConfig>): PartialDeep<ValaxyNodeConfig<ThemeConfig>>;
declare const defineConfig: typeof defineValaxyConfig;
declare const defaultSiteConfig: SiteConfig;
declare const defaultValaxyConfig: ValaxyNodeConfig;
type UnoSetup = () => Awaitable<Partial<VitePluginConfig> | undefined>;
declare function defineUnoSetup(fn: UnoSetup): UnoSetup;

declare function createServer(options: ResolvedValaxyOptions, viteConfig?: InlineConfig, serverOptions?: ValaxyServerOptions): Promise<vite.ViteDevServer>;

declare function getGitTimestamp(file: string, type?: 'created' | 'updated'): Promise<number>;

/**
 * is url external (http/https:)
 * @param str
 * @returns
 */
declare function isExternal(str: string): boolean;
/**
 * slash path for windows
 * @param str
 * @returns
 */
declare function slash(str: string): string;
declare function ensurePrefix(prefix: string, str: string): string;
declare function toAtFS(path: string): string;
declare function isPath(name: string): boolean;

/**
 * merge valaxy.config
 * (source, default)
 */
declare const mergeValaxyConfig: <Source extends {
    [x: string]: any;
    [x: number]: any;
    [x: symbol]: any;
}, Defaults extends ({
    [x: string]: any;
    [x: number]: any;
    [x: symbol]: any;
} | (number | boolean | any[] | Record<never, any> | null | undefined))[]>(source: Source, ...defaults: Defaults) => defu.Defu<Source, Defaults>;
/**
 * resolve valaxy config from special root
 * @param options
 * @returns
 */
declare function resolveValaxyConfigFromRoot(root: string, options?: ResolvedValaxyOptions): Promise<{
    config: ValaxyNodeConfig;
    configFile: string;
}>;
/**
 * resolve user valaxy config
 * options only have userRoot
 * @param options
 * @param viteConfig
 * @returns
 */
declare function resolveValaxyConfig(options: ValaxyEntryOptions): Promise<{
    config: ValaxyNodeConfig;
    configFile: string;
    theme: string;
}>;
declare function resolveAddonConfig(addons: ValaxyAddonResolver[], options?: ResolvedValaxyOptions): Promise<ValaxyNodeConfig>;

/**
 * transform obj for vite code
 * @param obj
 * @returns
 */
declare function transformObject(obj: any): string;
declare function resolveImportPath(importName: string, ensure?: true): string;

export { ResolvedValaxyOptions, UnoSetup, UserValaxyNodeConfig, ValaxyAddonExport, ValaxyAddonFn, ValaxyAddonLike, ValaxyAddonResolver, ValaxyAddons, ValaxyConfigExport, ValaxyConfigExtendKey, ValaxyConfigFn, ValaxyEntryOptions, ValaxyExtendConfig, ValaxyNodeConfig, ValaxyPickConfig, ValaxyServerOptions, ValaxyTheme, build, createServer, defaultSiteConfig, defaultValaxyConfig, defineAddon, defineConfig, defineSiteConfig, defineTheme, defineUnoSetup, defineValaxyAddon, defineValaxyConfig, defineValaxyTheme, ensurePrefix, getGitTimestamp, getIndexHtml, isExternal, isPath, mergeValaxyConfig, mergeViteConfigs, postProcessForSSG, processValaxyOptions, resolveAddonConfig, resolveImportPath, resolveOptions, resolveThemeValaxyConfig, resolveValaxyConfig, resolveValaxyConfigFromRoot, slash, ssgBuild, toAtFS, transformObject };
